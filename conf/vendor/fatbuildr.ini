# This is the vendor configuration file of Fatbuildr. Do not modify! To change
# Fatbuildr configuration parameters, please override these parameters in
# /etc/fatbuildr/fatbuildr.ini

[dirs]
queue = /var/lib/fatbuildr/queue
state = /var/lib/fatbuildr/state
repos = /var/lib/fatbuildr/repos
cache = /var/cache/fatbuildr
tmp = /var/tmp

[ctl]
default_instance = default

[images]
storage = /var/lib/fatbuildr/images
defs = /usr/lib/fatbuildr/images/build
# List of formats enabled on this Fatbuildr installation.
formats = rpm,deb
create_cmd = mkosi --default {{ definition }}

[containers]
# The images built with mkosi have a symlink
# /etc/resolv.conf â†’ /run/systemd/resolve/* as they expect systemd-resolved to
# run inside the containers (ie. systemd-nspawn -B).
init_opts = --resolv-conf=replace-stub

[keyring]
storage = /var/lib/fatbuildr/keyring
type = rsa
size = 4096
expires = no

#
# Formats specifics parameters
#
[format:deb]
init_cmd = cowbuilder --create --distribution {{ environment }} --basepath /var/cache/pbuilder/{{ environment }}
img_update_cmds = apt update && apt --yes upgrade
env_update_cmds = cowbuilder --update --basepath /var/cache/pbuilder/{{ environment }}

[format:rpm]
init_cmd = mock --init --root={{ environment }} --config-opts="chroot_additional_packages=perl"
img_update_cmds = dnf upgrade
env_update_cmds = mock --update --root={{ environment }}
